# PRISM COMPLETE SYSTEM v11.0
## â›” UPLOAD THIS SINGLE FILE TO CLAUDE PROJECT KNOWLEDGE
## Contains: ALL protocols, skills, automation, enforcement, MATHEMATICAL CERTAINTY
## Supersedes: ALL previous versions (v8, v9, v10, etc.)
---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 0: MANDATORY FIRST ACTIONS (EVERY SESSION - NO EXCEPTIONS)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## â›” STOP. Execute these IMMEDIATELY before ANY other work:

### ACTION 1: READ STATE FILE
```
Tool: Filesystem:read_file
Path: C:\PRISM\state\CURRENT_STATE.json
```
**Execute this tool call NOW. Do not proceed without it.**

### ACTION 2: QUOTE quickResume
After reading, say exactly: "State verified. quickResume: [exact content from file]"

### ACTION 3: CHECK STATUS & DECIDE
```
IF currentTask.status = "IN_PROGRESS":
    â†’ RESUME from checkpoint
    â†’ DO NOT restart
    â†’ DO NOT re-read files already processed
    
IF currentTask.status = "COMPLETE":
    â†’ May start new task
    â†’ Proceed to ACTION 4
```

### ACTION 4: LOAD MATHEMATICAL INFRASTRUCTURE
```
Tool: Filesystem:read_file
Path: C:\PRISM\data\FORMULA_REGISTRY.json
Path: C:\PRISM\data\COEFFICIENT_DATABASE.json

CHECK: Any calibrations stale (>30 days)?
CHECK: Any coefficient alerts?
```

### ACTION 5: DECOMPOSE WITH MATHPLAN
Before ANY work begins, PROVE mathematically:
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                         MATHPLAN GATE (MANDATORY)                             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  â–¡ SCOPE:        S = [nâ‚ Ã— nâ‚‚ Ã— ...] = [EXACT TOTAL]                         â•‘
â•‘  â–¡ COMPLETENESS: C(T) = Î£ Done(i) / n = 1.0 required                         â•‘
â•‘  â–¡ DECOMPOSE:    Î£|dáµ¢| = S (prove algebraically)                             â•‘
â•‘  â–¡ EFFORT:       [value] Â± [uncertainty] calls ([confidence]% CI)            â•‘
â•‘  â–¡ TIME:         [value] Â± [uncertainty] minutes ([confidence]% CI)          â•‘
â•‘  â–¡ MS_COUNT:     âŒˆEFFORT/15âŒ‰ = [N] microsessions                             â•‘
â•‘  â–¡ CONSTRAINTS:  C1: [math], C2: [math], ...                                 â•‘
â•‘  â–¡ ORDER:        Execute sequence [1,2,3,...], checkpoints at [X]            â•‘
â•‘  â–¡ SUCCESS:      When [mathematical criteria]                                 â•‘
â•‘                                                                               â•‘
â•‘  ALL CHECKED? â†’ Proceed    ANY UNCHECKED? â†’ STOP, complete MATHPLAN          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### ACTION 6: LOAD RELEVANT SKILLS
Based on task keywords, read from C:\PRISM\skills\

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 1: THE 8 ALWAYS-ON LAWS (Level 0 - CANNOT BE DISABLED)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## LAW 1: LIFE-SAFETY MINDSET ğŸ”´
This is manufacturing intelligence controlling CNC machines that can KILL.
**Test:** "Would I trust this calculation if MY life depended on it?"

## LAW 2: MANDATORY MICROSESSIONS ğŸ”´
**EVERY task MUST be decomposed BEFORE execution.**
- Chunk size: 15-25 items per microsession
- Max tool calls per MS: 15
- Checkpoint: At every MS boundary

## LAW 3: MAXIMUM COMPLETENESS ğŸ”´
100% coverage. No partial implementations. No "good enough."
C(T) = 1.0 required. C(T) = 0.99 is FAILURE.

## LAW 4: ANTI-REGRESSION ğŸ”´
New â‰¥ Old. Always. Before replacement: inventory old â†’ inventory new â†’ compare â†’ justify.

## LAW 5: PREDICTIVE THINKING ğŸ”´
Before EVERY action: 3 failure modes + mitigations + rollback plan.

## LAW 6: SESSION CONTINUITY ğŸ”´
State must be maintained across compactions and sessions. Checkpoint frequently.

## LAW 7: VERIFICATION CHAIN ğŸ”´
Every safety-critical output requires 4-level verification. 95% confidence required.

## LAW 8: CONTINUOUS MATHEMATICAL EVOLUTION ğŸ”´ (NEW)
```
EVERY formula, coefficient, and constant MUST:
  1. Have a version number
  2. Have uncertainty bounds  
  3. Have calibration status
  4. Have performance metrics
  5. Evolve based on empirical evidence

EVOLUTION CYCLE:
  Predict â†’ Execute â†’ Measure â†’ Compare â†’ Calibrate â†’ Validate â†’ Deploy

VIOLATION = Mathematical debt = Technical debt Ã— 10
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 2: THE 15 COMMANDMENTS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### UTILIZATION (1-3)
1. **USE EVERYWHERE** - 100% DB/engine utilization. Min 6-8 consumers per database.
2. **FUSE** - Cross-domain concepts (materials + physics + tooling + limits)
3. **WIRE BEFORE RELEASE** - NO module without ALL consumers wired

### QUALITY (4-6)
4. **VERIFY Ã— 3** - Min 3 sources (physics + empirical + historical)
5. **UNCERTAINTY ALWAYS** - NEVER bare numbers. Always value Â± error (confidence%)
6. **EXPLAIN EVERYTHING** - XAI for all recommendations

### ROBUSTNESS (7-9)
7. **FAIL GRACEFULLY** - Fallbacks for every failure mode. Never crash.
8. **PROTECT EVERYTHING** - Validate, sanitize, backup before changes
9. **DEFENSIVE CODING** - Validate ALL inputs, handle ALL edge cases

### PERFORMANCE (10-11)
10. **PERFORM ALWAYS** - <2s load, <500ms calculations, 99.9% uptime
11. **OPTIMIZE INTELLIGENTLY** - Measure before optimizing, cache frequently

### USER (12-13)
12. **OBSESS OVER USERS** - 3-click rule, smart defaults, instant feedback
13. **NEVER LOSE USER DATA** - Auto-save, undo, recovery from ANY failure

### LEARNING (14-15)
14. **LEARN FROM EVERYTHING** - Every interaction feeds _LEARNING pipeline
15. **IMPROVE CONTINUOUSLY** - Extract patterns, update recommendations

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 3: HARD STOPS (NON-NEGOTIABLE)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âŒ NEVER DO THESE
- Work without reading CURRENT_STATE.json first
- Restart an IN_PROGRESS task (MUST resume from checkpoint)
- Execute task without MATHPLAN gate completion
- Output any number without uncertainty bounds
- Exceed 18 tool calls without checkpoint
- Save PRISM work to /home/claude/ (resets every session)
- Replace file without anti-regression audit
- Import module without all consumers wired
- Proceed when S(x) < 0.70 OR M(x) < 0.60
- Skip prediction logging for estimates

## âœ… ALWAYS DO THESE
- Read state first, quote quickResume
- Load formula registry and coefficient database
- Complete MATHPLAN gate before execution
- Include uncertainty on ALL numerical outputs: value Â± error (CI%)
- Log all predictions to PREDICTION_LOG.json
- Record actuals after task completion
- Resume IN_PROGRESS tasks from checkpoint
- Checkpoint at yellow zone (9-14 calls)
- Update state file after significant steps

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 4: CRITICAL PATHS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
ROOT:              C:\PRISM\
STATE:             C:\PRISM\state\CURRENT_STATE.json
SCRIPTS:           C:\PRISM\scripts\
SKILLS:            C:\PRISM\skills\
DATA:              C:\PRISM\data\
MATERIALS:         C:\PRISM\data\materials\
MACHINES:          C:\PRISM\data\machines\
EXTRACTED:         C:\PRISM\extracted\
LOGS:              C:\PRISM\state\logs\
LEARNING:          C:\PRISM\state\learning\

MATHEMATICAL INFRASTRUCTURE:
FORMULA_REGISTRY:  C:\PRISM\data\FORMULA_REGISTRY.json
COEFFICIENT_DB:    C:\PRISM\data\COEFFICIENT_DATABASE.json
PREDICTION_LOG:    C:\PRISM\state\learning\PREDICTION_LOG.json
```

**âš ï¸ NEVER save to /home/claude/ - RESETS EVERY SESSION**

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 5: TOOL REFERENCE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

| Task | Tool | Parameters |
|------|------|------------|
| Read C: file | `Filesystem:read_file` | path |
| Write C: file | `Filesystem:write_file` | path, content |
| List C: dir | `Filesystem:list_directory` | path |
| Edit C: file | `Filesystem:edit_file` | path, edits |
| Large file read | `Desktop Commander:read_file` | path, offset, length |
| Append to file | `Desktop Commander:write_file` | path, content, mode:"append" |
| Content search | `Desktop Commander:start_search` | searchType:"content", pattern, path |
| Run Python | `Desktop Commander:start_process` | command, timeout_ms |

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 6: PYTHON ORCHESTRATORS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

### Run Intelligent Swarm (56 Agents)
```powershell
py -3 C:\PRISM\scripts\prism_unified_system_v4.py --intelligent "Task"
```

### Manufacturing Analysis (8 Experts)
```powershell
py -3 C:\PRISM\scripts\prism_orchestrator_v2.py --manufacturing "Material" "Operation"
```

### Ralph Loop (Iterate Until Perfect)
```powershell
py -3 C:\PRISM\scripts\prism_unified_system_v4.py --ralph agent "Prompt" iterations
```

### List All Agents
```powershell
py -3 C:\PRISM\scripts\prism_unified_system_v4.py --list
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 7: THE MASTER EQUATION (Î© v2.0)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
Î©(x) = w_RÂ·R(x) + w_CÂ·C(x) + w_PÂ·P(x) + w_SÂ·S(x) + w_LÂ·L(x) + w_MÂ·M(x)

COMPONENTS:
R(x) = Reasoning quality [0-1]
C(x) = Code quality [0-1]
P(x) = Process efficiency [0-1]
S(x) = Safety score [0-1]
L(x) = Learning integration [0-1]
M(x) = Mathematical rigor [0-1]  â† NEW

WEIGHTS (sum = 1.0):
w_R = 0.20 Â± 0.02
w_C = 0.18 Â± 0.02
w_P = 0.12 Â± 0.02
w_S = 0.28 Â± 0.02
w_L = 0.08 Â± 0.02
w_M = 0.14 Â± 0.02  â† NEW

HARD CONSTRAINTS:
S(x) â‰¥ 0.70 REQUIRED (safety gate)
M(x) â‰¥ 0.60 REQUIRED (rigor gate)  â† NEW

If S(x) < 0.70 OR M(x) < 0.60: Î©(x) FORCED to 0

THRESHOLDS:
Î© â‰¥ 0.90: RELEASE
0.70 â‰¤ Î© < 0.90: WARN
Î© < 0.70: BLOCK
```

## Mathematical Rigor Score M(x):
```
M(x) = (U(x) + D(x) + E(x) + V(x)) / 4

WHERE:
U(x) = Uncertainty coverage [0-1]  (all outputs have Â± bounds)
D(x) = Dimensional consistency [0-1]  (units verified)
E(x) = Evolution compliance [0-1]  (formulas calibrated)
V(x) = Verification coverage [0-1]  (proofs provided)
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 8: MATHEMATICAL INFRASTRUCTURE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## FORMULA REGISTRY (C:\PRISM\data\FORMULA_REGISTRY.json)
```
Contains 15+ formulas with:
- Unique ID (F-DOMAIN-NNN)
- Version number
- Variables with units
- Coefficients used
- Calibration status
- Performance metrics (MAE, MAPE, RÂ², Bias)
- Dependencies and dependents
```

## COEFFICIENT DATABASE (C:\PRISM\data\COEFFICIENT_DATABASE.json)
```
Contains 23+ coefficients with:
- Current value Â± uncertainty (confidence%)
- Calibration status: CALIBRATED | ESTIMATED | UNCALIBRATED | FIXED
- History of changes
- Usage tracking
```

## PREDICTION LOG (C:\PRISM\state\learning\PREDICTION_LOG.json)
```
Tracks every estimate for calibration:
- Predicted values with uncertainty
- Actual values (when complete)
- Residuals (predicted - actual)
- Aggregate metrics for recalibration
```

## CALIBRATION TRIGGERS
```
RECALIBRATE WHEN:
1. dataPoints â‰¥ 10 since last calibration
2. MAPE > 20%
3. |Bias| > 10%
4. Days since calibration > 30
```

## ALERT LEVELS
```
ğŸ”´ CRITICAL: MAPE > 50% or |Bias| > 25% â†’ Halt formula use
ğŸŸ  WARNING:  MAPE > 20% or |Bias| > 10% â†’ Schedule recalibration
ğŸŸ¡ NOTICE:   Calibration > 30 days old â†’ Review needed
ğŸŸ¢ HEALTHY:  All metrics within bounds â†’ Continue monitoring
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 9: UNCERTAINTY OUTPUT FORMAT (MANDATORY)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ALL numerical outputs MUST follow:
```
[VALUE] Â± [UNCERTAINTY] [UNIT] ([CONFIDENCE]% CI)

EXAMPLES:
  âœ“ 412 Â± 85 tool calls (95% CI)
  âœ“ 27.3 Â± 5.5 minutes (95% CI)
  âœ“ 0.847 Â± 0.023 coverage (95% CI)
  âœ“ 1,540 Â± 0 materials (exact count)
  
  âœ— 412 tool calls              â† NO UNCERTAINTY
  âœ— About 400 calls             â† VAGUE
  âœ— 412 Â± 85 calls              â† NO CONFIDENCE LEVEL
```

## ERROR PROPAGATION RULES
```
Addition/Subtraction: Ïƒ_z = âˆš(Ïƒ_xÂ² + Ïƒ_yÂ²)
Multiplication/Division: Ïƒ_z/z = âˆš[(Ïƒ_x/x)Â² + (Ïƒ_y/y)Â²]
Power (z = xâ¿): Ïƒ_z/z = |n| Ã— (Ïƒ_x/x)
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 10: CORE MATHEMATICAL FORMULAS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID          â”‚ FORMULA                        â”‚ PURPOSE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ F-PLAN-001  â”‚ C(T) = Î£ Done(i) / n           â”‚ Task completeness            â”‚
â”‚ F-PLAN-002  â”‚ EFFORT = Î£(Base Ã— Cmplx Ã— Risk)â”‚ Effort estimation            â”‚
â”‚ F-PLAN-003  â”‚ TCC = C Ã— V Ã— (1-E)            â”‚ Completion confidence        â”‚
â”‚ F-PLAN-004  â”‚ MS_COUNT = âŒˆEFFORT/15âŒ‰         â”‚ Microsession count           â”‚
â”‚ F-PLAN-005  â”‚ TIME = EFFORT Ã— t_avg Ã— buffer â”‚ Time estimation              â”‚
â”‚ F-MAT-001   â”‚ MCI = Î£(w Ã— has) / Î£w          â”‚ Material coverage index      â”‚
â”‚ F-MAT-002   â”‚ DUF = Î£ min(cons/6, 1) / n     â”‚ Database utilization         â”‚
â”‚ F-QUAL-001  â”‚ Î© = Î£ wáµ¢ Ã— Componentáµ¢          â”‚ Master equation              â”‚
â”‚ F-QUAL-002  â”‚ S = (verify Ã— risk Ã— bounds)/3 â”‚ Safety score                 â”‚
â”‚ F-QUAL-003  â”‚ M = (U + D + E + V) / 4        â”‚ Mathematical rigor           â”‚
â”‚ F-PHYS-001  â”‚ Fc = Kc1.1 Ã— b Ã— h^(1-mc)      â”‚ Kienzle cutting force        â”‚
â”‚ F-PHYS-002  â”‚ V Ã— T^n = C                    â”‚ Taylor tool life             â”‚
â”‚ F-PHYS-003  â”‚ Ïƒ = (A+BÎµâ¿)(1+Cln ÎµÌ‡*)(1-T*áµ)  â”‚ Johnson-Cook flow stress     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 11: 92 SKILLS BY LEVEL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Level 0: Always-On (4)
```
prism-deep-learning
prism-formula-evolution          â† NEW
prism-uncertainty-propagation    â† NEW
prism-mathematical-planning      â† NEW (MATHPLAN)
```

## Level 1: Cognitive - Î© Equation (6)
```
prism-universal-formulas, prism-reasoning-engine, prism-code-perfection
prism-process-optimizer, prism-safety-framework, prism-master-equation
```

## Level 2: Core Workflow SP.1 (8)
```
prism-sp-brainstorm, prism-sp-planning, prism-sp-execution
prism-sp-review-spec, prism-sp-review-quality, prism-sp-debugging
prism-sp-verification, prism-sp-handoff
```

## Level 3: Domain Skills (16)
```
Monolith: index, extractor, navigator
Materials: schema, physics, lookup, validator, enhancer
Masters: session, quality, code, knowledge, expert, controller, dev-utilities, validator
```

## Level 4: Reference Skills (20)
```
CNC: fanuc-programming, siemens-programming, heidenhain-programming, gcode-reference
Experts: 10 domain expert roles
References: api-contracts, error-catalog, manufacturing-tables, wiring-templates, 
            product-calculators, post-processor-reference
```

## Unclassified (38)
Various utility skills

**Total: 92 skills**

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 12: 56 API AGENTS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## By Tier
- **OPUS (15):** architect, coordinator, materials_scientist, machinist, physics_validator, domain_expert, migration_specialist, synthesizer, debugger, root_cause_analyst, task_decomposer, learning_extractor, verification_chain, uncertainty_quantifier, meta_analyst
- **SONNET (32):** extractor, validator, merger, coder, analyst, researcher, tool_engineer, cam_specialist, quality_engineer, process_engineer, machine_specialist, gcode_expert, monolith_navigator, schema_designer, api_designer, completeness_auditor, regression_checker, test_generator, code_reviewer, optimizer, refactorer, security_auditor, documentation_writer, thermal_calculator, force_calculator, estimator, context_builder, cross_referencer, pattern_matcher, quality_gate, session_continuity, dependency_analyzer
- **HAIKU (9):** state_manager, cutting_calculator, surface_calculator, standards_expert, formula_lookup, material_lookup, tool_lookup, call_tracer, knowledge_graph_builder

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 13: BUFFER ZONES & CHECKPOINTING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

| Zone | Tool Calls | Required Action |
|------|------------|-----------------|
| ğŸŸ¢ GREEN | 0-8 | Work freely |
| ğŸŸ¡ YELLOW | 9-14 | "Yellow zone. Checkpoint after current unit." |
| ğŸŸ  ORANGE | 15-18 | "Orange zone. Checkpointing NOW." Save immediately. |
| ğŸ”´ RED | 19+ | "RED ZONE. Emergency checkpoint." Stop all work. |

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 14: AUTO-SKILL LOADING
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

| Keywords | Skills to Load |
|----------|----------------|
| brainstorm, design, plan | prism-sp-brainstorm, prism-mathematical-planning |
| extract, parse, monolith | prism-monolith-extractor |
| material, alloy, steel | prism-material-schema, prism-material-physics |
| debug, fix, error | prism-sp-debugging |
| verify, validate | prism-sp-verification |
| gcode, fanuc | prism-fanuc-programming |
| siemens, sinumerik | prism-siemens-programming |
| session, state, resume | prism-session-master |
| formula, equation, calibrate | prism-formula-evolution |
| uncertainty, error, confidence | prism-uncertainty-propagation |
| estimate, predict, effort | prism-mathematical-planning |

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 15: VERIFICATION CHAIN (4 Levels)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

| Level | Type | Description |
|-------|------|-------------|
| 1 | Self | Verify own output |
| 2 | Peer | Independent check |
| 3 | Cross | Physics + empirical |
| 4 | Historical | Pattern match |

**95% confidence required for safety-critical outputs**

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 16: SESSION PROTOCOLS
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Session Start
1. Read CURRENT_STATE.json
2. Quote quickResume exactly
3. Check status (IN_PROGRESS â†’ resume)
4. Load FORMULA_REGISTRY.json
5. Load COEFFICIENT_DATABASE.json
6. Check calibration staleness
7. Complete MATHPLAN gate for new tasks
8. Load relevant skills

## During Execution
1. Log ALL predictions to PREDICTION_LOG.json
2. Include uncertainty on ALL outputs
3. Checkpoint at yellow zone
4. Track progress against estimates

## Session End
1. Complete current MS or checkpoint
2. Record actuals for completed predictions
3. Compute residuals
4. Check calibration triggers
5. Update CURRENT_STATE.json
6. Write session log
7. Announce next action

## 5-Second Resume
```
DOING:   [one-line what]
STOPPED: [one-line where]
NEXT:    [one-line action]
MATH:    [key predictions with Â± uncertainty]
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 17: PREDICTION LOGGING PROTOCOL
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Every Estimate MUST Be Logged:
```json
{
  "id": "PRED-YYYYMMDD-NNN",
  "formulaId": "F-PLAN-002",
  "task": "Description",
  "predicted": {
    "effort": {"value": 412, "uncertainty": 85, "ci": 0.95},
    "time": {"value": 27.3, "uncertainty": 5.5, "ci": 0.95}
  },
  "actual": null,
  "status": "PENDING_ACTUAL"
}
```

## After Task Completion, UPDATE:
```json
{
  "actual": {"effort": 387, "time": 24.1},
  "residuals": {"effort": -25, "time": -3.2},
  "percentError": {"effort": -6.1, "time": -11.7},
  "status": "COMPLETE"
}
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 18: EMERGENCY PROCEDURES
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## If Context Compacted
1. Read CURRENT_STATE.json immediately
2. Check quickResume for context
3. Resume from documented position

## If Task Restarting
1. STOP immediately
2. Read CURRENT_STATE.json
3. If IN_PROGRESS: Resume from checkpoint

## If Safety S(x) < 0.70
1. STOP all work
2. Announce safety violation
3. Request additional verification
4. Do NOT proceed until S(x) â‰¥ 0.70

## If Mathematical Rigor M(x) < 0.60
1. STOP all work
2. Check: Are all outputs with uncertainty?
3. Check: Are formulas calibrated?
4. Check: Are units consistent?
5. Fix deficiencies before proceeding

## If Formula MAPE > 20%
1. Flag formula for recalibration
2. Increase uncertainty bounds temporarily (Ã—1.5)
3. Schedule recalibration within 3 sessions

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 19: MATHPLAN DECOMPOSITION EXAMPLE
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TASK: Audit 1,540 materials for 127-parameter completeness
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

SCOPE QUANTIFICATION:
S = Materials Ã— Parameters = 1,540 Ã— 127 = 195,580 cells

DECOMPOSITION PROOF:
dâ‚ = P_STEELS:     849 Ã— 127 = 107,823 cells
dâ‚‚ = N_NONFERROUS: 398 Ã— 127 =  50,546 cells
dâ‚ƒ = M_STAINLESS:  191 Ã— 127 =  24,257 cells
dâ‚„ = K_CAST_IRON:   54 Ã— 127 =   6,858 cells
dâ‚… = S_SUPERALLOYS: 28 Ã— 127 =   3,556 cells
dâ‚† = H_HARDENED:    10 Ã— 127 =   1,270 cells
dâ‚‡ = X_SPECIALTY:   10 Ã— 127 =   1,270 cells
                              â”€â”€â”€â”€â”€â”€â”€â”€â”€
Î£|dáµ¢| =                        195,580 = S âœ“

EFFORT ESTIMATION:
Base = 44 files Ã— 4 ops/file = 176 calls
Complexity factors: 1.5 Ã— 1.2 Ã— 1.3 = 2.34
EFFORT = 176 Ã— 2.34 = 412 Â± 85 calls (95% CI)
MS_COUNT = âŒˆ412/15âŒ‰ = 28 Â± 6 microsessions (95% CI)
TIME = 412 Ã— 3s Ã— 1.5 = 1,854s = 30.9 Â± 6.2 min (95% CI)

CONSTRAINTS:
C1: âˆ€(m,p): Checked[m,p] âˆˆ {0,1}
C2: âˆ€m: Î£â‚š Checked[m,p] = 127
C3: Final count = 195,580

EXECUTION ORDER:
1â†’2â†’3â†’4â†’5â†’6â†’7 (by ISO group, largest first)
Checkpoints: After each group

SUCCESS CRITERIA:
C(audit) = 195,580 / 195,580 = 1.0

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MATHPLAN GATE: PASSED âœ“
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 20: SYSTEM SUMMARY
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   PRISM MANUFACTURING INTELLIGENCE v11.0                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ROOT:      C:\PRISM\                                                        â•‘
â•‘  SKILLS:    92 (5 levels + unclassified)                                     â•‘
â•‘  AGENTS:    56 (15 OPUS, 32 SONNET, 9 HAIKU)                                 â•‘
â•‘  FORMULAS:  15+ registered in FORMULA_REGISTRY.json                          â•‘
â•‘  COEFFICIENTS: 23+ tracked in COEFFICIENT_DATABASE.json                      â•‘
â•‘  MATERIALS: 1,540+ @ 127 parameters                                          â•‘
â•‘  MONOLITH:  986,621 lines | 831 modules                                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  ENFORCEMENT:                                                                â•‘
â•‘  â€¢ 8 Always-On Laws (immutable)                                              â•‘
â•‘  â€¢ 15 Commandments (expanded)                                                â•‘
â•‘  â€¢ State verification gate                                                   â•‘
â•‘  â€¢ MATHPLAN gate (mathematical proof required)                               â•‘
â•‘  â€¢ Microsession decomposition                                                â•‘
â•‘  â€¢ Resume enforcement                                                        â•‘
â•‘  â€¢ Checkpoint gates (buffer zones)                                           â•‘
â•‘  â€¢ Safety constraint S(x) â‰¥ 0.70                                             â•‘
â•‘  â€¢ Rigor constraint M(x) â‰¥ 0.60                                              â•‘
â•‘  â€¢ 4-level verification chain                                                â•‘
â•‘  â€¢ Uncertainty on ALL outputs                                                â•‘
â•‘  â€¢ Prediction logging for calibration                                        â•‘
â•‘  â€¢ Continuous formula evolution                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

**THIS IS MANUFACTURING INTELLIGENCE. LIVES DEPEND ON MATHEMATICAL CERTAINTY.**

**Version:** 11.0 | **Created:** 2026-01-26 | **Supersedes:** v10.0


---

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# SECTION 21: HOOK SYSTEM v1.1 (AUTOMATIC ENFORCEMENT)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## Overview
The Hook System transforms manual discipline into **automatic enforcement**.
147 hook points across 25 categories execute at every operation, ensuring
the 8 Laws and 15 Commandments are followed without relying on memory.

## Hook Location
```
C:\PRISM\src\core\hooks\
â”œâ”€â”€ HookSystem.types.ts     # 1,905 lines - Base types (107 hooks)
â”œâ”€â”€ HookSystem.extended.ts  # 684 lines - Extended types (40 hooks)
â”œâ”€â”€ HookManager.ts          # 739 lines - Runtime engine
â”œâ”€â”€ index.ts                # Public API
```

## 15 System Hooks (CANNOT DISABLE)

| ID | Enforces | Priority | Action |
|----|----------|----------|--------|
| SYS-LAW1-SAFETY | Law 1 | 0 | Blocks if S(x) < 0.70 |
| SYS-LAW2-MICROSESSION | Law 2 | 32 | Requires MATHPLAN |
| SYS-LAW3-COMPLETENESS | Law 3 | 33 | Requires C(T) = 1.0 |
| SYS-LAW4-REGRESSION | Law 4 | 20 | Blocks data loss |
| SYS-LAW5-PREDICTIVE | Law 5 | 30 | Reminds failure modes |
| SYS-LAW6-CONTINUITY | Law 6 | 10 | Loads state, enforces resume |
| SYS-LAW7-VERIFICATION | Law 7 | 0 | Requires 95% confidence |
| SYS-LAW8-MATH-EVOLUTION | Law 8 | 60 | Requires M(x) >= 0.60 |
| SYS-MATHPLAN-GATE | Law 2+8 | 5 | Validates MATHPLAN |
| SYS-CMD1-WIRING | Cmd 1 | 110 | Min 6-8 consumers |
| SYS-CMD5-UNCERTAINTY | Cmd 5 | 60 | Injects uncertainty |
| SYS-PREDICTION-LOG | Law 8 | 200 | Logs predictions |
| SYS-CALIBRATION-MONITOR | Law 8 | 220 | Monitors formulas |
| SYS-LEARNING-EXTRACT | Cmd 14 | 170 | Extracts learnings |
| SYS-BUFFER-ZONE | Law 2 | 0 | Enforces checkpoints |

## 25 Hook Categories (147 Total)

### Base Categories (107 hooks)
| Category | Count | Key Hooks |
|----------|-------|-----------|
| Session | 7 | preStart, postStart, preEnd, heartbeat |
| Task | 10 | prePlan, mathPlanValidate, checkpoint, complete |
| Microsession | 5 | start, bufferWarning, complete |
| Database | 10 | preValidate, antiRegressionCheck, consumerWiringCheck |
| Material | 6 | completenessCheck, cascade, crossValidate |
| Calculation | 8 | dimensionalCheck, safetyBoundsCheck, xaiExplain |
| Formula | 8 | calibrationCheck, coefficientUpdate |
| Prediction | 5 | create, recordActual, triggerCalibration |
| Agent | 6 | preExecute, postExecute, costTrack |
| Swarm | 6 | preStart, progress, synthesize |
| Ralph | 6 | iterationStart, completionCheck |
| Learning | 7 | extract, match, apply, propagate |
| Verification | 5 | start, levelComplete, chainComplete |
| Quality | 4 | gateCheck, gateAggregate |
| Skill | 4 | detect, load, execute |
| Script | 4 | preExecute, postExecute |
| Plugin | 6 | preAction, browserAction |

### Extended Categories (40 hooks) - v1.1
| Category | Count | Purpose |
|----------|-------|---------|
| Transaction | 5 | Atomic ops, rollback, commit |
| Health | 5 | Memory pressure, heartbeat, alerts |
| Cache | 5 | Hit/miss, invalidation, warming |
| Circuit Breaker | 4 | Failure threshold, recovery |
| Rate Limiting | 4 | Throttle, quota tracking |
| Audit Trail | 4 | Compliance, change log |
| Feature Flag | 4 | A/B test, canary rollout |
| MCP Integration | 5 | Connect, disconnect, errors |
| Planning Integration | 4 | Overhead calculation |

## Priority System (0-999)
```
0-29:    SYSTEM_CRITICAL (SAFETY, MATHPLAN, STATE)
30-49:   LAW_ENFORCEMENT
50-99:   VALIDATION (Schema, Uncertainty, Dimensional)
100-199: BUSINESS_LOGIC + INTELLIGENCE
200-299: METRICS + MONITORING
300-399: USER_HOOKS
400-499: PLUGIN_HOOKS
900-999: CLEANUP + LOGGING
```

## Hook Execution Flow
```
OPERATION START
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execute Pre-    â”‚ â—„â”€â”€ Hooks can BLOCK (return continue: false)
â”‚ Operation Hooks â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ continue: true
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execute         â”‚
â”‚ Operation       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Execute Post-   â”‚ â—„â”€â”€ Hooks can LOG, LEARN, ALERT
â”‚ Operation Hooks â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    OPERATION END
```

## Planning Formulas (Hook-Aware)

### F-PLAN-002 v2.0: Effort Estimation
```
EFFORT = Î£(Base Ã— Complexity Ã— Risk) Ã— HOOK_FACTOR Ã— COORD_FACTOR Ã— VERIFY_FACTOR

Where:
  HOOK_FACTOR  = 1 + (n_hooks Ã— t_hook / t_avg)   // ~1.05-1.15
  COORD_FACTOR = 1 + (agents-1) Ã— k_coord         // ~1.05 per agent
  VERIFY_FACTOR = 1 + (levels Ã— k_verify)         // ~1.08 per level
```

### F-PLAN-005 v2.0: Time Estimation
```
TIME = EFFORT Ã— AVG_TIME Ã— BUFFER + LATENCY_OVERHEAD

Where:
  LATENCY_OVERHEAD = t_state + t_context + (levels Ã— t_verify_level) + t_learn
```

## Hook-Related Coefficients (9 new in v1.1)
| ID | Name | Value | Unit |
|----|------|-------|------|
| K-HOOK-001 | Hook Execution Time | 5 Â± 2 | ms |
| K-HOOK-002 | Hooks Per Operation | 3.2 Â± 0.8 | hooks/op |
| K-COORD-001 | Agent Coordination | 0.05 Â± 0.02 | - |
| K-VERIFY-001 | Verification Level | 0.08 Â± 0.03 | - |
| K-LEARN-001 | Learning Extraction | 0.03 Â± 0.01 | - |
| K-LATENCY-001 | State Load | 50 Â± 20 | ms |
| K-LATENCY-002 | Context Build | 100 Â± 40 | ms |
| K-LATENCY-003 | Verification Latency | 200 Â± 80 | ms |
| K-LATENCY-004 | Learning Latency | 150 Â± 50 | ms |

## Integration with Workflow

### Session Start (ACTION 1 triggers hooks)
```
session:preStart  â†’ Load CURRENT_STATE.json
session:postStart â†’ Verify math infrastructure loaded
```

### Task Execution (ACTION 5 triggers hooks)
```
task:prePlan        â†’ Check for MATHPLAN
task:mathPlanValidate â†’ Validate scope, decomposition, estimates
task:start          â†’ Log prediction
task:checkpoint     â†’ Buffer zone check
task:postComplete   â†’ Record actual, compute residual
```

### Database Mutations (All writes trigger hooks)
```
db:preValidate           â†’ Schema check
db:antiRegressionCheck   â†’ Block if data loss
db:consumerWiringCheck   â†’ Enforce min 6-8 consumers
db:postWrite             â†’ Log to audit trail
```

## Usage Examples

### Execute Hooks in Code
```typescript
import { executeHooks } from '@prism/core/hooks';

// Before task start
const result = await executeHooks('task:prePlan', {
  task: { id: 'T-001', name: 'Extract tools' },
  mathPlan: null  // Will be blocked!
}, context);

if (result.aborted) {
  console.error('BLOCKED:', result.abortReason);
  // "MATHPLAN gate failed: No MATHPLAN provided"
}
```

### Register Custom Hook
```typescript
import { registerHook, PRIORITY } from '@prism/core/hooks';

registerHook('custom-material-validator', 'material:preValidate',
  async (payload, context) => {
    if (payload.material.hardness > 70) {
      return {
        continue: true,
        warnings: ['High hardness material - verify tool selection']
      };
    }
    return { continue: true };
  },
  { priority: PRIORITY.BUSINESS_RULES }
);
```

## Related Skills
- `prism-hook-system.md` - Quick reference
- `prism-sp-brainstorm.md` â†’ task:prePlan hooks
- `prism-sp-execution.md` â†’ task:checkpoint hooks
- `prism-sp-verification.md` â†’ verification:* hooks
- `prism-formula-evolution.md` â†’ formula:* hooks

---

**Version:** 11.1 | **Updated:** 2026-01-26 | **Hook System:** v1.1

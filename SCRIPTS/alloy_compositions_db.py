#!/usr/bin/env python3
"""
Standard AISI/SAE/ASTM alloy compositions database.
All values are nominal wt% (midpoint of specification range).
Sources: ASTM A29/A304/A351, SAE J403/J404, UNS designations.
"""

ALLOY_COMPOSITIONS = {
    # ══════════════════════════════════════════════════════════════════════════
    # CARBON STEELS (AISI 10xx series) — SAE J403
    # ══════════════════════════════════════════════════════════════════════════
    "1006": {"C": 0.06, "Mn": 0.35, "P": 0.040, "S": 0.050},
    "1008": {"C": 0.08, "Mn": 0.35, "P": 0.040, "S": 0.050},
    "1010": {"C": 0.10, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1012": {"C": 0.12, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1015": {"C": 0.15, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1016": {"C": 0.16, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1017": {"C": 0.17, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1018": {"C": 0.18, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1019": {"C": 0.19, "Mn": 0.85, "P": 0.040, "S": 0.050},
    "1020": {"C": 0.20, "Mn": 0.45, "P": 0.040, "S": 0.050},
    "1021": {"C": 0.20, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1022": {"C": 0.22, "Mn": 0.80, "P": 0.040, "S": 0.050},
    "1023": {"C": 0.23, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1025": {"C": 0.25, "Mn": 0.45, "P": 0.040, "S": 0.050},
    "1026": {"C": 0.26, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1029": {"C": 0.29, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1030": {"C": 0.30, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1035": {"C": 0.35, "Mn": 0.70, "P": 0.040, "S": 0.050},
    "1037": {"C": 0.37, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1038": {"C": 0.38, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1039": {"C": 0.39, "Mn": 0.80, "P": 0.040, "S": 0.050},
    "1040": {"C": 0.40, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1042": {"C": 0.42, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1043": {"C": 0.43, "Mn": 0.80, "P": 0.040, "S": 0.050},
    "1044": {"C": 0.44, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1045": {"C": 0.45, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1046": {"C": 0.46, "Mn": 0.80, "P": 0.040, "S": 0.050},
    "1049": {"C": 0.49, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1050": {"C": 0.50, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1053": {"C": 0.52, "Mn": 0.85, "P": 0.040, "S": 0.050},
    "1055": {"C": 0.55, "Mn": 0.70, "P": 0.040, "S": 0.050},
    "1059": {"C": 0.59, "Mn": 0.85, "P": 0.040, "S": 0.050},
    "1060": {"C": 0.60, "Mn": 0.70, "P": 0.040, "S": 0.050},
    "1065": {"C": 0.65, "Mn": 0.70, "P": 0.040, "S": 0.050},
    "1070": {"C": 0.70, "Mn": 0.65, "P": 0.040, "S": 0.050},
    "1074": {"C": 0.74, "Mn": 0.65, "P": 0.040, "S": 0.050},
    "1075": {"C": 0.75, "Mn": 0.65, "P": 0.040, "S": 0.050},
    "1078": {"C": 0.78, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1080": {"C": 0.80, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1084": {"C": 0.84, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1085": {"C": 0.85, "Mn": 0.75, "P": 0.040, "S": 0.050},
    "1086": {"C": 0.86, "Mn": 0.40, "P": 0.040, "S": 0.050},
    "1090": {"C": 0.90, "Mn": 0.65, "P": 0.040, "S": 0.050},
    "1095": {"C": 0.95, "Mn": 0.40, "P": 0.040, "S": 0.050},

    # ══════════════════════════════════════════════════════════════════════════
    # MANGANESE STEELS (AISI 15xx series)
    # ══════════════════════════════════════════════════════════════════════════
    "1330": {"C": 0.30, "Mn": 1.65, "P": 0.035, "S": 0.040, "Si": 0.25},
    "1335": {"C": 0.35, "Mn": 1.65, "P": 0.035, "S": 0.040, "Si": 0.25},
    "1340": {"C": 0.40, "Mn": 1.65, "P": 0.035, "S": 0.040, "Si": 0.25},
    "1345": {"C": 0.45, "Mn": 1.65, "P": 0.035, "S": 0.040, "Si": 0.25},
    "1513": {"C": 0.13, "Mn": 1.25, "P": 0.040, "S": 0.050},
    "1518": {"C": 0.18, "Mn": 1.25, "P": 0.040, "S": 0.050},
    "1522": {"C": 0.22, "Mn": 1.25, "P": 0.040, "S": 0.050},
    "1524": {"C": 0.24, "Mn": 1.45, "P": 0.040, "S": 0.050},
    "1541": {"C": 0.41, "Mn": 1.50, "P": 0.040, "S": 0.050},
    "1548": {"C": 0.48, "Mn": 1.25, "P": 0.040, "S": 0.050},

    # ══════════════════════════════════════════════════════════════════════════
    # FREE-MACHINING STEELS (AISI 11xx, 12xx series)
    # ══════════════════════════════════════════════════════════════════════════
    "1108": {"C": 0.08, "Mn": 0.55, "P": 0.040, "S": 0.10},
    "1117": {"C": 0.17, "Mn": 1.10, "P": 0.040, "S": 0.10},
    "1137": {"C": 0.37, "Mn": 1.50, "P": 0.040, "S": 0.10},
    "1141": {"C": 0.41, "Mn": 1.50, "P": 0.040, "S": 0.10},
    "1144": {"C": 0.44, "Mn": 1.50, "P": 0.040, "S": 0.25},
    "1211": {"C": 0.13, "Mn": 0.75, "P": 0.10, "S": 0.13},
    "1212": {"C": 0.13, "Mn": 0.85, "P": 0.10, "S": 0.18},
    "1213": {"C": 0.13, "Mn": 0.85, "P": 0.10, "S": 0.28},
    "1215": {"C": 0.09, "Mn": 0.85, "P": 0.06, "S": 0.30},
    "12L14": {"C": 0.09, "Mn": 0.85, "P": 0.06, "S": 0.30, "Pb": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # CHROMIUM-MOLYBDENUM STEELS (AISI 41xx series) — SAE J404
    # ══════════════════════════════════════════════════════════════════════════
    "4023": {"C": 0.23, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4024": {"C": 0.24, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4027": {"C": 0.27, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4028": {"C": 0.28, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4037": {"C": 0.37, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4042": {"C": 0.42, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4047": {"C": 0.47, "Mn": 0.80, "Mo": 0.25, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4118": {"C": 0.18, "Mn": 0.80, "Cr": 0.50, "Mo": 0.12, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4130": {"C": 0.30, "Mn": 0.50, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4135": {"C": 0.35, "Mn": 0.80, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4137": {"C": 0.37, "Mn": 0.80, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4140": {"C": 0.40, "Mn": 0.88, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4142": {"C": 0.42, "Mn": 0.88, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4145": {"C": 0.45, "Mn": 0.88, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4147": {"C": 0.47, "Mn": 0.88, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},
    "4150": {"C": 0.50, "Mn": 0.88, "Cr": 0.95, "Mo": 0.20, "P": 0.035, "S": 0.040, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # NICKEL-CHROMIUM-MOLYBDENUM STEELS (AISI 43xx, 47xx, 86xx, 87xx, 93xx)
    # ══════════════════════════════════════════════════════════════════════════
    "4320": {"C": 0.20, "Mn": 0.55, "Ni": 1.82, "Cr": 0.50, "Mo": 0.25, "Si": 0.25},
    "4330": {"C": 0.30, "Mn": 0.85, "Ni": 1.82, "Cr": 0.80, "Mo": 0.40, "Si": 0.25},
    "4340": {"C": 0.40, "Mn": 0.70, "Ni": 1.82, "Cr": 0.80, "Mo": 0.25, "Si": 0.25},
    "4615": {"C": 0.15, "Mn": 0.48, "Ni": 1.82, "Mo": 0.25, "Si": 0.25},
    "4620": {"C": 0.20, "Mn": 0.55, "Ni": 1.82, "Mo": 0.25, "Si": 0.25},
    "4718": {"C": 0.18, "Mn": 0.75, "Ni": 1.05, "Cr": 0.45, "Mo": 0.35, "Si": 0.25},
    "4720": {"C": 0.20, "Mn": 0.55, "Ni": 1.05, "Cr": 0.45, "Mo": 0.20, "Si": 0.25},
    "4815": {"C": 0.15, "Mn": 0.45, "Ni": 3.50, "Mo": 0.25, "Si": 0.25},
    "4820": {"C": 0.20, "Mn": 0.60, "Ni": 3.50, "Mo": 0.25, "Si": 0.25},
    "8615": {"C": 0.15, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8617": {"C": 0.17, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8620": {"C": 0.20, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8625": {"C": 0.25, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8630": {"C": 0.30, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8637": {"C": 0.37, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8640": {"C": 0.40, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8642": {"C": 0.42, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8645": {"C": 0.45, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8650": {"C": 0.50, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8655": {"C": 0.55, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8660": {"C": 0.60, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.20, "Si": 0.25},
    "8720": {"C": 0.20, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.25, "Si": 0.25},
    "8740": {"C": 0.40, "Mn": 0.80, "Ni": 0.55, "Cr": 0.50, "Mo": 0.25, "Si": 0.25},
    "9254": {"C": 0.54, "Mn": 0.70, "Cr": 0.70, "Si": 1.40},
    "9255": {"C": 0.55, "Mn": 0.80, "Cr": 0.70, "Si": 2.00},
    "9260": {"C": 0.60, "Mn": 0.88, "Cr": 0.00, "Si": 2.00},
    "9310": {"C": 0.10, "Mn": 0.55, "Ni": 3.25, "Cr": 1.20, "Mo": 0.12, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # CHROMIUM STEELS (AISI 51xx, 52xx series)
    # ══════════════════════════════════════════════════════════════════════════
    "5115": {"C": 0.15, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "5120": {"C": 0.20, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "5130": {"C": 0.30, "Mn": 0.80, "Cr": 0.95, "Si": 0.25},
    "5132": {"C": 0.32, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "5135": {"C": 0.35, "Mn": 0.80, "Cr": 0.88, "Si": 0.25},
    "5140": {"C": 0.40, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "5150": {"C": 0.50, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "5155": {"C": 0.55, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "5160": {"C": 0.60, "Mn": 0.80, "Cr": 0.80, "Si": 0.25},
    "52100": {"C": 1.00, "Mn": 0.35, "Cr": 1.45, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # NICKEL-CHROMIUM STEELS (AISI 31xx, 32xx, 33xx, 34xx)
    # ══════════════════════════════════════════════════════════════════════════
    "3140": {"C": 0.40, "Mn": 0.70, "Ni": 1.25, "Cr": 0.65, "Si": 0.25},
    "3310": {"C": 0.10, "Mn": 0.55, "Ni": 3.50, "Cr": 1.57, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # VANADIUM STEELS (AISI 61xx series)
    # ══════════════════════════════════════════════════════════════════════════
    "6150": {"C": 0.50, "Mn": 0.80, "Cr": 0.95, "V": 0.15, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # HIGH-STRENGTH LOW-ALLOY & SPECIALTY
    # ══════════════════════════════════════════════════════════════════════════
    "300M": {"C": 0.42, "Mn": 0.75, "Ni": 1.80, "Cr": 0.82, "Mo": 0.40,
             "V": 0.08, "Si": 1.60},
    "Maraging250": {"C": 0.03, "Ni": 18.0, "Co": 7.5, "Mo": 4.8, "Ti": 0.40,
                    "Al": 0.10},
    "Maraging300": {"C": 0.03, "Ni": 18.5, "Co": 9.0, "Mo": 4.8, "Ti": 0.60,
                    "Al": 0.10},
    "Maraging350": {"C": 0.03, "Ni": 18.0, "Co": 12.0, "Mo": 4.8, "Ti": 1.40,
                    "Al": 0.10},

    # ══════════════════════════════════════════════════════════════════════════
    # STAINLESS STEELS — AUSTENITIC (AISI 2xx, 3xx)
    # ══════════════════════════════════════════════════════════════════════════
    "201": {"C": 0.08, "Mn": 6.50, "Cr": 17.0, "Ni": 4.5, "N": 0.15, "Si": 0.50},
    "202": {"C": 0.08, "Mn": 8.50, "Cr": 18.0, "Ni": 5.0, "N": 0.15, "Si": 0.50},
    "301": {"C": 0.08, "Mn": 1.00, "Cr": 17.0, "Ni": 7.0, "Si": 0.50},
    "302": {"C": 0.08, "Mn": 1.00, "Cr": 18.0, "Ni": 9.0, "Si": 0.50},
    "303": {"C": 0.08, "Mn": 1.00, "Cr": 18.0, "Ni": 9.0, "S": 0.20, "Si": 0.50},
    "304": {"C": 0.04, "Mn": 1.00, "Cr": 18.5, "Ni": 9.0, "Si": 0.50},
    "304L": {"C": 0.02, "Mn": 1.00, "Cr": 18.5, "Ni": 9.5, "Si": 0.50},
    "305": {"C": 0.06, "Mn": 1.00, "Cr": 18.0, "Ni": 12.0, "Si": 0.50},
    "308": {"C": 0.04, "Mn": 1.00, "Cr": 20.0, "Ni": 11.0, "Si": 0.50},
    "309": {"C": 0.10, "Mn": 1.00, "Cr": 23.0, "Ni": 13.5, "Si": 0.50},
    "310": {"C": 0.12, "Mn": 1.00, "Cr": 25.0, "Ni": 20.5, "Si": 0.75},
    "314": {"C": 0.12, "Mn": 1.00, "Cr": 24.0, "Ni": 20.0, "Si": 2.00},
    "316": {"C": 0.04, "Mn": 1.00, "Cr": 17.0, "Ni": 12.0, "Mo": 2.50, "Si": 0.50},
    "316L": {"C": 0.02, "Mn": 1.00, "Cr": 17.0, "Ni": 12.0, "Mo": 2.50, "Si": 0.50},
    "316Ti": {"C": 0.04, "Mn": 1.00, "Cr": 17.0, "Ni": 12.0, "Mo": 2.50,
              "Ti": 0.40, "Si": 0.50},
    "317": {"C": 0.04, "Mn": 1.00, "Cr": 19.0, "Ni": 13.0, "Mo": 3.50, "Si": 0.50},
    "317L": {"C": 0.02, "Mn": 1.00, "Cr": 19.0, "Ni": 13.0, "Mo": 3.50, "Si": 0.50},
    "321": {"C": 0.04, "Mn": 1.00, "Cr": 18.0, "Ni": 10.5, "Ti": 0.40, "Si": 0.50},
    "347": {"C": 0.04, "Mn": 1.00, "Cr": 18.0, "Ni": 11.0, "Nb": 0.60, "Si": 0.50},
    "904L": {"C": 0.01, "Mn": 1.00, "Cr": 20.0, "Ni": 25.0, "Mo": 4.50,
             "Cu": 1.50, "Si": 0.50},

    # ══════════════════════════════════════════════════════════════════════════
    # STAINLESS STEELS — FERRITIC (AISI 4xx)
    # ══════════════════════════════════════════════════════════════════════════
    "405": {"C": 0.04, "Mn": 0.50, "Cr": 13.0, "Al": 0.20, "Si": 0.50},
    "409": {"C": 0.04, "Mn": 0.50, "Cr": 11.0, "Ti": 0.30, "Si": 0.50},
    "430": {"C": 0.06, "Mn": 0.50, "Cr": 17.0, "Si": 0.50},
    "434": {"C": 0.06, "Mn": 0.50, "Cr": 17.0, "Mo": 1.00, "Si": 0.50},
    "436": {"C": 0.06, "Mn": 0.50, "Cr": 17.0, "Mo": 1.00, "Nb": 0.40, "Si": 0.50},
    "442": {"C": 0.10, "Mn": 0.50, "Cr": 21.0, "Si": 0.50},
    "446": {"C": 0.10, "Mn": 0.75, "Cr": 25.0, "N": 0.15, "Si": 0.50},

    # ══════════════════════════════════════════════════════════════════════════
    # STAINLESS STEELS — MARTENSITIC (AISI 4xx)
    # ══════════════════════════════════════════════════════════════════════════
    "403": {"C": 0.08, "Mn": 0.50, "Cr": 12.25, "Si": 0.25},
    "410": {"C": 0.08, "Mn": 0.50, "Cr": 12.50, "Si": 0.50},
    "414": {"C": 0.08, "Mn": 0.50, "Cr": 12.50, "Ni": 1.88, "Si": 0.50},
    "416": {"C": 0.08, "Mn": 0.63, "Cr": 13.0, "S": 0.20, "Si": 0.50},
    "420": {"C": 0.30, "Mn": 0.50, "Cr": 13.0, "Si": 0.50},
    "431": {"C": 0.10, "Mn": 0.50, "Cr": 16.0, "Ni": 2.00, "Si": 0.50},
    "440A": {"C": 0.68, "Mn": 0.50, "Cr": 17.0, "Mo": 0.50, "Si": 0.50},
    "440B": {"C": 0.82, "Mn": 0.50, "Cr": 17.0, "Mo": 0.50, "Si": 0.50},
    "440C": {"C": 1.05, "Mn": 0.50, "Cr": 17.0, "Mo": 0.50, "Si": 0.50},

    # ══════════════════════════════════════════════════════════════════════════
    # STAINLESS STEELS — DUPLEX
    # ══════════════════════════════════════════════════════════════════════════
    "2205": {"C": 0.02, "Mn": 1.50, "Cr": 22.0, "Ni": 5.5, "Mo": 3.0,
             "N": 0.17, "Si": 0.50},
    "2507": {"C": 0.02, "Mn": 0.80, "Cr": 25.0, "Ni": 7.0, "Mo": 4.0,
             "N": 0.28, "Si": 0.50},
    "2304": {"C": 0.02, "Mn": 1.50, "Cr": 23.0, "Ni": 4.5, "Mo": 0.30,
             "N": 0.10, "Si": 0.50},

    # ══════════════════════════════════════════════════════════════════════════
    # STAINLESS STEELS — PRECIPITATION HARDENING
    # ══════════════════════════════════════════════════════════════════════════
    "17-4PH": {"C": 0.04, "Mn": 0.50, "Cr": 16.25, "Ni": 4.0, "Cu": 3.50,
               "Nb": 0.25, "Si": 0.50},
    "15-5PH": {"C": 0.04, "Mn": 0.50, "Cr": 15.0, "Ni": 4.5, "Cu": 3.50,
               "Nb": 0.30, "Si": 0.50},
    "13-8Mo": {"C": 0.03, "Mn": 0.10, "Cr": 12.75, "Ni": 8.0, "Mo": 2.25,
               "Al": 1.10, "Si": 0.10},
    "A286": {"C": 0.04, "Mn": 1.00, "Cr": 15.0, "Ni": 26.0, "Mo": 1.25,
             "Ti": 2.00, "V": 0.25, "B": 0.005, "Si": 0.50},
    "Custom455": {"C": 0.03, "Mn": 0.25, "Cr": 11.75, "Ni": 8.5, "Ti": 1.10,
                  "Cu": 2.00, "Nb": 0.15, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # TOOL STEELS — AISI designations
    # ══════════════════════════════════════════════════════════════════════════
    # Air-hardening (A-series)
    "A2": {"C": 1.00, "Mn": 0.65, "Cr": 5.25, "Mo": 1.10, "V": 0.25, "Si": 0.30},
    "A6": {"C": 0.70, "Mn": 2.00, "Cr": 1.00, "Mo": 1.35, "Si": 0.30},
    "A10": {"C": 1.35, "Mn": 1.80, "Ni": 1.80, "Mo": 1.50, "Si": 1.25},

    # Cold-work (D-series)
    "D2": {"C": 1.50, "Mn": 0.35, "Cr": 12.0, "Mo": 0.80, "V": 0.90, "Si": 0.35},
    "D3": {"C": 2.25, "Mn": 0.35, "Cr": 12.0, "V": 0.25, "Si": 0.35},
    "D6": {"C": 2.10, "Mn": 0.35, "Cr": 12.0, "W": 0.75, "V": 0.25, "Si": 0.35},
    "D7": {"C": 2.35, "Mn": 0.35, "Cr": 12.0, "Mo": 1.00, "V": 4.00, "Si": 0.35},

    # Hot-work (H-series)
    "H11": {"C": 0.36, "Mn": 0.35, "Cr": 5.00, "Mo": 1.50, "V": 0.40, "Si": 1.00},
    "H13": {"C": 0.40, "Mn": 0.35, "Cr": 5.25, "Mo": 1.50, "V": 1.00, "Si": 1.00},
    "H21": {"C": 0.35, "Mn": 0.30, "Cr": 3.50, "W": 9.50, "V": 0.45, "Si": 0.30},
    "H42": {"C": 0.60, "Mn": 0.30, "Cr": 4.00, "W": 6.00, "Mo": 5.00, "V": 2.00, "Si": 0.30},

    # High-speed (M-series)
    "M1": {"C": 0.85, "Mn": 0.30, "Cr": 4.00, "W": 1.75, "Mo": 8.50, "V": 1.15, "Si": 0.30},
    "M2": {"C": 0.85, "Mn": 0.30, "Cr": 4.15, "W": 6.35, "Mo": 5.00, "V": 1.90, "Si": 0.30},
    "M4": {"C": 1.30, "Mn": 0.30, "Cr": 4.25, "W": 5.50, "Mo": 4.50, "V": 4.00, "Si": 0.30},
    "M42": {"C": 1.10, "Mn": 0.30, "Cr": 3.75, "W": 1.50, "Mo": 9.50, "V": 1.15,
            "Co": 8.00, "Si": 0.30},

    # High-speed (T-series)
    "T1": {"C": 0.75, "Mn": 0.30, "Cr": 4.00, "W": 18.0, "V": 1.10, "Si": 0.25},
    "T15": {"C": 1.55, "Mn": 0.30, "Cr": 4.00, "W": 12.5, "Mo": 0.50, "V": 5.00,
            "Co": 5.00, "Si": 0.25},

    # Oil-hardening (O-series)
    "O1": {"C": 0.95, "Mn": 1.10, "Cr": 0.50, "W": 0.50, "V": 0.20, "Si": 0.30},

    # Shock-resistant (S-series)
    "S7": {"C": 0.50, "Mn": 0.70, "Cr": 3.25, "Mo": 1.40, "Si": 0.25},

    # Water-hardening (W-series)
    "W1": {"C": 1.00, "Mn": 0.25, "Cr": 0.15, "V": 0.10, "Si": 0.25},

    # Mold (P-series)
    "P20": {"C": 0.35, "Mn": 0.80, "Cr": 1.70, "Mo": 0.40, "Si": 0.40},

    # Miscellaneous
    "L6": {"C": 0.70, "Mn": 0.75, "Ni": 1.50, "Cr": 0.75, "Mo": 0.25, "Si": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # ALUMINUM ALLOYS — AA designations (nominal compositions)
    # ══════════════════════════════════════════════════════════════════════════
    "AA1100": {"Al": 99.0, "Cu": 0.12, "Mn": 0.05, "Fe": 0.50, "Si": 0.25},
    "AA2011": {"Al": 93.7, "Cu": 5.5, "Bi": 0.40, "Pb": 0.40},
    "AA2014": {"Al": 93.5, "Cu": 4.4, "Si": 0.80, "Mn": 0.80, "Mg": 0.50},
    "AA2017": {"Al": 93.5, "Cu": 4.0, "Mn": 0.70, "Mg": 0.60, "Si": 0.50},
    "AA2024": {"Al": 93.5, "Cu": 4.4, "Mg": 1.50, "Mn": 0.60},
    "AA2117": {"Al": 95.3, "Cu": 2.6, "Mg": 0.35},
    "AA2218": {"Al": 93.5, "Cu": 4.0, "Mg": 1.50, "Ni": 2.00},
    "AA2618": {"Al": 93.7, "Cu": 2.3, "Mg": 1.55, "Fe": 1.10, "Ni": 1.05, "Ti": 0.07, "Si": 0.18},
    "AA3003": {"Al": 98.6, "Mn": 1.20, "Cu": 0.12},
    "AA3004": {"Al": 97.8, "Mn": 1.20, "Mg": 1.00},
    "AA3105": {"Al": 98.2, "Mn": 0.55, "Mg": 0.50, "Cu": 0.30},
    "AA4032": {"Al": 85.0, "Si": 12.2, "Mg": 1.00, "Cu": 0.90, "Ni": 0.90},
    "AA4043": {"Al": 94.8, "Si": 5.00, "Fe": 0.20},
    "AA5005": {"Al": 99.2, "Mg": 0.80},
    "AA5052": {"Al": 97.2, "Mg": 2.50, "Cr": 0.25},
    "AA5056": {"Al": 94.8, "Mg": 5.00, "Mn": 0.12, "Cr": 0.12},
    "AA5083": {"Al": 94.7, "Mg": 4.40, "Mn": 0.70, "Cr": 0.15},
    "AA5086": {"Al": 95.4, "Mg": 4.00, "Mn": 0.45, "Cr": 0.15},
    "AA5154": {"Al": 96.2, "Mg": 3.50, "Cr": 0.25},
    "AA5454": {"Al": 96.3, "Mg": 2.70, "Mn": 0.80, "Cr": 0.12},
    "AA6005": {"Al": 98.5, "Mg": 0.50, "Si": 0.70, "Mn": 0.10},
    "AA6010": {"Al": 97.3, "Mg": 0.80, "Si": 1.00, "Cu": 0.35, "Mn": 0.50},
    "AA6013": {"Al": 96.7, "Mg": 1.00, "Si": 0.80, "Cu": 0.90, "Mn": 0.35},
    "AA6061": {"Al": 97.9, "Mg": 1.00, "Si": 0.60, "Cu": 0.28, "Cr": 0.20},
    "AA6063": {"Al": 98.9, "Mg": 0.70, "Si": 0.40},
    "AA6066": {"Al": 96.7, "Mg": 1.10, "Si": 1.40, "Cu": 1.00, "Mn": 0.80},
    "AA6082": {"Al": 97.5, "Mg": 0.90, "Si": 1.00, "Mn": 0.50},
    "AA7049": {"Al": 89.8, "Zn": 7.7, "Mg": 2.45, "Cu": 1.60, "Cr": 0.15},
    "AA7050": {"Al": 89.0, "Zn": 6.2, "Mg": 2.25, "Cu": 2.30, "Zr": 0.12},
    "AA7055": {"Al": 88.0, "Zn": 8.0, "Mg": 2.05, "Cu": 2.30, "Zr": 0.12},
    "AA7075": {"Al": 90.0, "Zn": 5.6, "Mg": 2.50, "Cu": 1.60, "Cr": 0.23},
    "AA7178": {"Al": 88.1, "Zn": 6.8, "Mg": 2.80, "Cu": 2.00, "Cr": 0.23},
    # Cast aluminum
    "AA319": {"Al": 85.5, "Si": 6.0, "Cu": 3.50, "Mn": 0.50, "Fe": 1.00, "Mg": 0.10},
    "AA333": {"Al": 83.5, "Si": 9.0, "Cu": 3.50, "Mg": 0.30, "Fe": 1.00},
    "AA355": {"Al": 92.0, "Si": 5.0, "Cu": 1.25, "Mg": 0.50, "Fe": 0.20},
    "AA356": {"Al": 92.0, "Si": 7.0, "Mg": 0.35, "Fe": 0.15},
    "AA380": {"Al": 82.5, "Si": 8.5, "Cu": 3.50, "Fe": 1.30, "Zn": 3.00},
    "AA390": {"Al": 78.0, "Si": 17.0, "Cu": 4.50, "Mg": 0.60},
    "AA413": {"Al": 88.0, "Si": 12.0, "Fe": 0.60},

    # ══════════════════════════════════════════════════════════════════════════
    # TITANIUM ALLOYS
    # ══════════════════════════════════════════════════════════════════════════
    "TiCP1": {"Ti": 99.5, "Fe": 0.10, "O": 0.18, "N": 0.03, "C": 0.05},
    "TiCP2": {"Ti": 99.3, "Fe": 0.20, "O": 0.25, "N": 0.03, "C": 0.05},
    "TiCP3": {"Ti": 99.1, "Fe": 0.25, "O": 0.35, "N": 0.05, "C": 0.05},
    "TiCP4": {"Ti": 98.8, "Fe": 0.30, "O": 0.40, "N": 0.05, "C": 0.05},
    "Ti6Al4V": {"Ti": 90.0, "Al": 6.0, "V": 4.0, "Fe": 0.20, "O": 0.15},
    "Ti6Al2Sn4Zr2Mo": {"Ti": 82.0, "Al": 6.0, "Sn": 2.0, "Zr": 4.0, "Mo": 2.0},
    "Ti3Al25V": {"Ti": 94.5, "Al": 3.0, "V": 2.5},
    "Ti5Al25Sn": {"Ti": 92.5, "Al": 5.0, "Sn": 2.5},
    "Ti6Al6V2Sn": {"Ti": 84.0, "Al": 6.0, "V": 6.0, "Sn": 2.0, "Cu": 0.75, "Fe": 0.80},
    "Ti10V2Fe3Al": {"Ti": 85.0, "V": 10.0, "Fe": 2.0, "Al": 3.0},
    "Ti15V3Cr3Al3Sn": {"Ti": 76.0, "V": 15.0, "Cr": 3.0, "Al": 3.0, "Sn": 3.0},

    # ══════════════════════════════════════════════════════════════════════════
    # NICKEL & COBALT SUPERALLOYS
    # ══════════════════════════════════════════════════════════════════════════
    "Inconel600": {"Ni": 76.0, "Cr": 15.5, "Fe": 8.0, "Mn": 0.25, "Si": 0.25,
                   "Cu": 0.25, "C": 0.04},
    "Inconel601": {"Ni": 60.5, "Cr": 23.0, "Fe": 14.0, "Al": 1.35, "Si": 0.25,
                   "Mn": 0.50, "C": 0.03},
    "Inconel617": {"Ni": 52.0, "Cr": 22.0, "Co": 12.5, "Mo": 9.0, "Al": 1.15,
                   "Ti": 0.30, "Fe": 1.50, "C": 0.07},
    "Inconel625": {"Ni": 61.0, "Cr": 21.5, "Mo": 9.0, "Nb": 3.65, "Fe": 2.50,
                   "Ti": 0.20, "Al": 0.20, "C": 0.05},
    "Inconel690": {"Ni": 60.0, "Cr": 30.0, "Fe": 9.0, "C": 0.02, "Si": 0.25},
    "Inconel706": {"Ni": 41.5, "Fe": 37.0, "Cr": 16.0, "Nb": 2.90, "Ti": 1.75,
                   "Al": 0.20, "C": 0.03},
    "Inconel718": {"Ni": 52.5, "Cr": 19.0, "Fe": 18.5, "Nb": 5.13, "Mo": 3.05,
                   "Ti": 0.90, "Al": 0.50, "C": 0.04},
    "InconelX750": {"Ni": 73.0, "Cr": 15.5, "Fe": 7.0, "Ti": 2.50, "Al": 0.70,
                    "Nb": 0.95, "C": 0.04},
    "Incoloy800": {"Ni": 32.5, "Cr": 21.0, "Fe": 39.5, "Ti": 0.38, "Al": 0.38,
                   "C": 0.05, "Mn": 0.75, "Si": 0.50},
    "Incoloy825": {"Ni": 42.0, "Cr": 21.5, "Fe": 28.0, "Mo": 3.0, "Cu": 2.0,
                   "Ti": 0.90, "C": 0.02},
    "Waspaloy": {"Ni": 58.0, "Cr": 19.5, "Co": 13.5, "Mo": 4.3, "Ti": 3.0,
                 "Al": 1.3, "C": 0.07, "B": 0.006},
    "HastelloyC276": {"Ni": 57.0, "Mo": 16.0, "Cr": 15.5, "Fe": 5.5, "W": 3.75,
                      "Co": 1.00, "Mn": 0.50, "V": 0.20, "C": 0.01},
    "HastelloyX": {"Ni": 47.0, "Cr": 22.0, "Fe": 18.5, "Mo": 9.0, "Co": 1.50,
                   "W": 0.60, "C": 0.10},
    "Monel400": {"Ni": 66.0, "Cu": 31.5, "Fe": 1.25, "Mn": 1.00, "Si": 0.25,
                 "C": 0.15},
    "MonelK500": {"Ni": 65.0, "Cu": 30.0, "Al": 2.75, "Ti": 0.60, "Fe": 1.00,
                  "C": 0.13},
    "Haynes25": {"Co": 50.0, "Cr": 20.0, "W": 15.0, "Ni": 10.0, "Fe": 3.00,
                 "Mn": 1.50, "C": 0.10},
    "Haynes188": {"Co": 37.0, "Ni": 22.0, "Cr": 22.0, "W": 14.5, "Fe": 3.00,
                  "La": 0.03, "C": 0.10},
    "Haynes230": {"Ni": 57.0, "Cr": 22.0, "W": 14.0, "Mo": 2.00, "Fe": 3.00,
                  "Co": 5.00, "Al": 0.30, "C": 0.10},
    "Rene41": {"Ni": 55.0, "Cr": 19.0, "Co": 11.0, "Mo": 10.0, "Ti": 3.10,
               "Al": 1.50, "Fe": 0.50, "C": 0.09},
    "Nimonic75": {"Ni": 80.0, "Cr": 19.5, "Ti": 0.40, "Fe": 2.50, "C": 0.08},
    "Nimonic80A": {"Ni": 76.0, "Cr": 19.5, "Ti": 2.40, "Al": 1.40, "Fe": 1.50,
                   "Co": 1.00, "C": 0.06},
    "Nimonic90": {"Ni": 60.0, "Cr": 19.5, "Co": 18.0, "Ti": 2.40, "Al": 1.40,
                  "C": 0.07},

    # ══════════════════════════════════════════════════════════════════════════
    # COPPER ALLOYS — UNS designations
    # ══════════════════════════════════════════════════════════════════════════
    "C10100": {"Cu": 99.99},  # OFE
    "C10200": {"Cu": 99.95},  # OF
    "C11000": {"Cu": 99.90},  # ETP
    "C14500": {"Cu": 99.50, "Te": 0.50},  # Tellurium copper
    "C17200": {"Cu": 97.8, "Be": 1.90, "Co": 0.25},  # BeCu
    "C17500": {"Cu": 97.2, "Be": 0.55, "Co": 2.50},
    "C22000": {"Cu": 90.0, "Zn": 10.0},  # Commercial bronze
    "C23000": {"Cu": 85.0, "Zn": 15.0},  # Red brass
    "C26000": {"Cu": 70.0, "Zn": 30.0},  # Cartridge brass
    "C26200": {"Cu": 68.5, "Zn": 31.5},
    "C27000": {"Cu": 65.0, "Zn": 35.0},  # Yellow brass
    "C28000": {"Cu": 60.0, "Zn": 40.0},  # Muntz metal
    "C36000": {"Cu": 61.5, "Zn": 35.5, "Pb": 3.00},  # Free-cutting brass
    "C51000": {"Cu": 94.8, "Sn": 5.0, "P": 0.20},  # Phosphor bronze
    "C52100": {"Cu": 91.8, "Sn": 8.0, "P": 0.20},
    "C63000": {"Cu": 82.0, "Al": 10.0, "Fe": 3.00, "Ni": 5.00},  # Ni-Al bronze
    "C71500": {"Cu": 70.0, "Ni": 30.0},  # Cu-Ni 70/30
    "C93200": {"Cu": 83.0, "Sn": 7.0, "Pb": 7.00, "Zn": 3.00},  # Bearing bronze

    # ══════════════════════════════════════════════════════════════════════════
    # CAST IRON — typical compositions
    # ══════════════════════════════════════════════════════════════════════════
    "GrayClass20": {"C": 3.40, "Si": 2.20, "Mn": 0.65, "S": 0.10, "P": 0.25},
    "GrayClass25": {"C": 3.30, "Si": 2.15, "Mn": 0.65, "S": 0.10, "P": 0.15},
    "GrayClass30": {"C": 3.20, "Si": 2.10, "Mn": 0.70, "S": 0.10, "P": 0.12},
    "GrayClass35": {"C": 3.10, "Si": 2.00, "Mn": 0.75, "S": 0.10, "P": 0.10},
    "GrayClass40": {"C": 3.00, "Si": 2.00, "Mn": 0.80, "S": 0.10, "P": 0.08},
    "GrayClass45": {"C": 2.90, "Si": 1.90, "Mn": 0.80, "S": 0.10, "P": 0.07},
    "GrayClass50": {"C": 2.80, "Si": 1.80, "Mn": 0.85, "S": 0.10, "P": 0.06},
    "GrayClass60": {"C": 2.70, "Si": 1.70, "Mn": 0.90, "S": 0.10, "P": 0.05},
    "Ductile60_40_18": {"C": 3.60, "Si": 2.50, "Mn": 0.35, "Mg": 0.04, "P": 0.03},
    "Ductile65_45_12": {"C": 3.50, "Si": 2.50, "Mn": 0.40, "Mg": 0.04, "P": 0.03},
    "Ductile80_55_06": {"C": 3.50, "Si": 2.80, "Mn": 0.40, "Mg": 0.04, "P": 0.03},
    "Ductile100_70_03": {"C": 3.50, "Si": 2.40, "Mn": 0.60, "Mg": 0.04, "P": 0.03},
    "Ductile120_90_02": {"C": 3.40, "Si": 2.30, "Mn": 0.80, "Mg": 0.04, "P": 0.03},
    "ADI900_6": {"C": 3.50, "Si": 2.50, "Mn": 0.35, "Mo": 0.20, "Mg": 0.04},
    "MalleableM3210": {"C": 2.40, "Si": 1.40, "Mn": 0.40, "S": 0.10},
    "CGI300": {"C": 3.50, "Si": 2.20, "Mn": 0.40, "Mg": 0.015},
    "CGI400": {"C": 3.40, "Si": 2.10, "Mn": 0.50, "Cu": 0.30, "Mg": 0.015},
    "WhiteIron": {"C": 3.00, "Si": 0.80, "Mn": 0.50, "Cr": 0.25},

    # ══════════════════════════════════════════════════════════════════════════
    # MAGNESIUM ALLOYS
    # ══════════════════════════════════════════════════════════════════════════
    "AZ31B": {"Mg": 96.0, "Al": 3.0, "Zn": 1.0, "Mn": 0.20},
    "AZ61A": {"Mg": 93.0, "Al": 6.0, "Zn": 1.0, "Mn": 0.15},
    "AZ80A": {"Mg": 91.5, "Al": 8.0, "Zn": 0.50, "Mn": 0.20},
    "AZ91D": {"Mg": 90.0, "Al": 9.0, "Zn": 0.70, "Mn": 0.15},
    "ZK60A": {"Mg": 94.0, "Zn": 5.5, "Zr": 0.45},

    # ══════════════════════════════════════════════════════════════════════════
    # REFRACTORY METALS
    # ══════════════════════════════════════════════════════════════════════════
    "Tungsten": {"W": 99.95},
    "Molybdenum": {"Mo": 99.95},
    "Tantalum": {"Ta": 99.95},
    "Niobium": {"Nb": 99.80},
    "Zirconium": {"Zr": 99.50, "Hf": 0.10},

    # ══════════════════════════════════════════════════════════════════════════
    # NICKEL ALLOYS (non-superalloy)
    # ══════════════════════════════════════════════════════════════════════════
    "Ni200": {"Ni": 99.5, "Fe": 0.15, "Mn": 0.18, "C": 0.08, "Si": 0.18},
    "Ni201": {"Ni": 99.5, "Fe": 0.15, "Mn": 0.18, "C": 0.01, "Si": 0.18},
    "Alloy20": {"Ni": 35.0, "Cr": 20.0, "Fe": 36.0, "Mo": 2.50, "Cu": 3.50,
                "Nb": 0.60, "Mn": 1.00, "C": 0.03},
    "Invar36": {"Ni": 36.0, "Fe": 64.0, "C": 0.02, "Mn": 0.35, "Si": 0.20},
    "Kovar": {"Ni": 29.0, "Co": 17.0, "Fe": 54.0, "Mn": 0.30, "Si": 0.20},
}

# Thermal conductivity model: k = k_iron - sum(beta_i * wt%_i)
# Additive model calibrated against published data (ASM, MakeItFrom, AZoM).
# Calibration points: 1045 (51.9), 4340 (44.5), 304 (16.2), 316 (16.3).
K_IRON = 80.0  # W/m·K at 25°C (pure iron)

BETA_COEFFICIENTS = {
    "C":  50.0,    # Carbon: very strong effect (carbide phases, lattice distortion)
    "Mn":  5.0,    # Manganese
    "Si": 12.0,    # Silicon: strong solid solution effect
    "Cr":  1.11,   # Chromium: moderate per wt% but high in stainless
    "Ni":  3.36,   # Nickel: significant per wt%
    "Mo":  8.0,    # Molybdenum
    "W":   7.0,    # Tungsten
    "V":   6.0,    # Vanadium
    "Co":  3.0,    # Cobalt
    "Cu":  1.0,    # Copper (minor effect)
    "Nb":  5.0,    # Niobium
    "Ti":  4.0,    # Titanium
    "Al":  2.0,    # Aluminum
    "N":  15.0,    # Nitrogen (strong interstitial)
    "S":   2.0,    # Sulfur
    "P":   3.0,    # Phosphorus
    "Pb":  0.5,    # Lead (negligible)
}


def calc_thermal_conductivity_steel(comp: dict) -> float:
    """Calculate thermal conductivity for ferrous alloys.
    Uses category-aware models calibrated against published data.
    Accuracy: ~5% for carbon steels, ~15% for alloy/tool/stainless steels."""
    cr = comp.get("Cr", 0)
    ni = comp.get("Ni", 0)
    mo = comp.get("Mo", 0)
    w = comp.get("W", 0)
    c = comp.get("C", 0)
    mn = comp.get("Mn", 0)
    si = comp.get("Si", 0)
    v = comp.get("V", 0)
    co = comp.get("Co", 0)
    nb = comp.get("Nb", 0)

    total_alloy = cr + ni + mo + w + v + co + nb

    # Category 1: Stainless steels (Cr > 10%)
    if cr > 10:
        # Empirical: k decreases with Cr+Ni+Mo content
        # Ferritic (Cr only): k ≈ 26 W/m·K at 13%Cr, 24 at 17%, 21 at 25%
        # Austenitic (Cr+Ni): k ≈ 15-16 for 18Cr-8Ni, 12-14 for high alloy
        if ni > 3:  # Austenitic or duplex
            k = 25.0 - 0.40 * cr - 0.55 * ni - 1.5 * mo
        else:  # Ferritic or martensitic
            k = 35.0 - 0.50 * cr - 1.0 * mo
        return max(8.0, round(k, 1))

    # Category 2: Tool steels (high C + high alloy)
    if total_alloy > 5 or (c > 0.7 and cr > 3):
        # Tool steels: k ranges 19-42 depending on composition
        # Base: ~42 for low-alloy types, decreasing with alloying
        k = 42.0 - 10 * c - 0.8 * cr - 1.2 * mo - 1.0 * w - 1.5 * v - 0.5 * co
        return max(15.0, round(k, 1))

    # Category 3: High-carbon bearing steels (52100-type)
    if c > 0.8 and cr > 0.5 and total_alloy < 5:
        k = 46.0 - 3.0 * c - 1.5 * cr
        return max(30.0, round(k, 1))

    # Category 4: Plain carbon and low-alloy steels
    # Calibrated: 1045->51.9, 4340->44.5, 4140->42.7
    k = K_IRON
    k -= 55.0 * c   # Carbon: ~55 per wt%
    k -= 5.0 * mn
    k -= 12.0 * si
    k -= 9.5 * cr   # Chromium: calibrated to match 4140
    k -= 4.5 * ni   # Nickel: calibrated to match 4340
    k -= 12.0 * mo
    k -= 7.0 * w
    k -= 6.0 * v
    k -= 3.0 * co
    return max(25.0, round(k, 1))


def calc_density_steel(comp: dict) -> float:
    """Calculate density for ferrous alloys using rule of mixtures.
    Returns density in g/cm³."""
    # Element densities (g/cm³) and atomic volumes
    elem_density = {
        "Fe": 7.874, "C": 2.267, "Mn": 7.440, "Si": 2.330, "Cr": 7.190,
        "Ni": 8.908, "Mo": 10.28, "W": 19.25, "V": 6.110, "Co": 8.900,
        "Cu": 8.960, "Nb": 8.570, "Ti": 4.507, "Al": 2.700, "N": 1.251,
        "S": 2.070, "P": 1.823, "Pb": 11.34, "Sn": 7.310, "Mg": 1.738,
        "Zn": 7.134, "Zr": 6.506, "Be": 1.850, "Ta": 16.65, "Hf": 13.31,
        "La": 6.162, "B": 2.370, "Te": 6.240, "O": 1.429, "Bi": 9.780,
    }
    # For steels, use the iron alloy density model
    # Base iron density, adjusted for alloying elements
    fe_pct = comp.get("Fe", 0)
    if fe_pct <= 0:
        # Calculate Fe as balance for steel
        total_alloy = sum(v for k, v in comp.items() if k != "Fe")
        if total_alloy < 100:
            fe_pct = 100.0 - total_alloy

    if fe_pct > 50:  # Iron-based
        # Simplified: adjust from 7.874 based on alloying
        rho = 7.874
        for elem, wt in comp.items():
            if elem == "Fe" or wt <= 0:
                continue
            e_rho = elem_density.get(elem, 7.874)
            # Volume fraction approximation
            rho += (e_rho - 7.874) * wt / 100.0
        return round(rho, 3)
    else:
        # Non-ferrous: weighted average
        total_wt = 0
        total_vol = 0
        for elem, wt in comp.items():
            if wt <= 0:
                continue
            e_rho = elem_density.get(elem, 5.0)
            total_wt += wt
            total_vol += wt / e_rho
        if total_vol > 0:
            return round(total_wt / total_vol, 3)
        return 7.874


# Total alloys count
_count = len(ALLOY_COMPOSITIONS)
